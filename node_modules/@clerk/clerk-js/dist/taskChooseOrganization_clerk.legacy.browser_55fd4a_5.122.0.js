"use strict";(globalThis.webpackChunk_clerk_clerk_js=globalThis.webpackChunk_clerk_clerk_js||[]).push([["7814"],{8181:function(t,a,e){e.d(a,{D:()=>s});var o=e(73312),i=e(6654),n=e(25623),r=e(64204),l=e(17703);let s=t=>{let{organization:a,showLoadingSpinner:e,...s}=t;return(0,o.BX)(r.Col,{elementDescriptor:r.descriptors.organizationAvatarUploaderContainer,children:[(0,o.tZ)(r.Text,{variant:"subtitle",sx:t=>({textAlign:"left",marginBottom:t.space.$2}),localizationKey:(0,l.u1)("organizationProfile.start.profileSection.uploadAction__title")}),(0,o.tZ)(i.C,{...s,title:(0,l.u1)("userProfile.profilePage.imageFormTitle"),avatarPreview:(0,o.tZ)(n.l,{size:t=>t.sizes.$16,showLoadingSpinner:e,...a})})]})}},57484:function(t,a,e){e.d(a,{AO:()=>o,Sz:()=>i});let o={userMemberships:{infinite:!0},userInvitations:{infinite:!0},userSuggestions:{infinite:!0,status:["pending","accepted"]}},i=(t,a,e)=>{var o;if(void 0===a)return[{data:[t],total_count:1}];let i=(null==a||null==(o=a[a.length-1])?void 0:o.total_count)||1;return a.map(a=>{if(void 0===a)return a;let o=a.data.map(a=>a.id===t.id?{...t}:a);return{...a,data:o,total_count:"negative"===e?i-1:i}})}},7008:function(t,a,e){e.r(a),e.d(a,{TaskChooseOrganization:()=>X}),e(65223);var o=e(73312),i=e(61869),n=e(69144),r=e(11576),l=e(64204),s=e(92418),c=e(2672),d=e(92654),u=e(54264),g=e(76028),h=e(25135),z=e(41024),p=e(20237),v=e(57484),m=e(86988),C=e(42305),y=e(35973),O=e(96519),Z=e(88870);let b=t=>{var a,e,n;let r=(0,c.useCardState)(),{user:u}=(0,i.aF)(),{ref:h,userMemberships:z,userSuggestions:v,userInvitations:m}=(0,g.H)(),y=(null==z?void 0:z.isLoading)||(null==m?void 0:m.isLoading)||(null==v?void 0:v.isLoading),O=(null==z?void 0:z.hasNextPage)||(null==m?void 0:m.hasNextPage)||(null==v?void 0:v.hasNextPage),Z=null==(a=m.data)?void 0:a.filter(t=>!!t),b=null==(e=v.data)?void 0:e.filter(t=>!!t);return(0,o.BX)(o.HY,{children:[(0,o.BX)(d.h.Root,{showLogo:!0,sx:t=>({padding:"".concat(t.space.$none," ").concat(t.space.$8)}),children:[(0,o.tZ)(d.h.Title,{localizationKey:(0,l.localizationKeys)("taskChooseOrganization.chooseOrganization.title")}),(0,o.tZ)(d.h.Subtitle,{localizationKey:(null==u?void 0:u.createOrganizationEnabled)?(0,l.localizationKeys)("taskChooseOrganization.chooseOrganization.subtitle"):(0,l.localizationKeys)("taskChooseOrganization.chooseOrganization.subtitle__createOrganizationDisabled")})]}),(0,o.tZ)(s.Z.Alert,{sx:t=>({margin:"".concat(t.space.$none," ").concat(t.space.$8)}),children:r.error}),(0,o.tZ)(l.Col,{elementDescriptor:l.descriptors.main,children:(0,o.tZ)(p.o2,{elementDescriptor:l.descriptors.taskChooseOrganizationPreviewItems,children:(0,o.BX)(C.eX,{role:"menu",children:[(z.count||0)>0&&(null==(n=z.data)?void 0:n.map(t=>(0,o.tZ)(k,{...t},t.id))),!z.hasNextPage&&(null==Z?void 0:Z.map(t=>(0,o.tZ)(_,{...t},t.id))),!z.hasNextPage&&!m.hasNextPage&&(null==b?void 0:b.map(t=>(0,o.tZ)(f,{...t},t.id))),(O||y)&&(0,o.tZ)(p.pr,{ref:h}),(0,o.tZ)(w,{onCreateOrganizationClick:()=>{r.setError(void 0),t.onCreateOrganizationClick()}})]})})})]})},k=t=>{let{user:a}=(0,i.aF)(),e=(0,c.useCardState)(),{navigateOnSetActive:n}=(0,m.G)(),{redirectUrlComplete:r}=(0,m._)(),{isLoaded:s,setActive:d}=(0,i.eW)(),{t:u}=(0,l.useLocalizations)();return s?(0,o.tZ)(p.Td,{elementDescriptor:l.descriptors.taskChooseOrganizationPreviewButton,onClick:()=>{let o;return o=t.organization,e.runAsync(async()=>{try{await d({organization:o,navigate:async t=>{let{session:a}=t;await (null==n?void 0:n({session:a,redirectUrlComplete:r}))}})}catch(o){var t,i;if(!(0,z.kD)(o))return void(0,Z.S3)(o,[],e.setError);switch(null==(i=o.errors)||null==(t=i[0])?void 0:t.code){case"organization_not_found_or_unauthorized":case"not_a_member_in_organization":(null==a?void 0:a.createOrganizationEnabled)?e.setError(u((0,l.localizationKeys)("unstable__errors.organization_not_found_or_unauthorized"))):e.setError(u((0,l.localizationKeys)("unstable__errors.organization_not_found_or_unauthorized_with_create_organization_disabled")));break;default:(0,Z.S3)(o,[],e.setError)}}})},children:(0,o.tZ)(y.Z,{elementId:"taskChooseOrganization",mainIdentifierSx:p.fq,organization:t.organization})}):null},_=t=>{let a=(0,c.useCardState)(),{getOrganization:e}=(0,i.cL)(),[r,s]=(0,n.useState)(null),{userInvitations:d}=(0,i.eW)({userInvitations:v.AO.userInvitations});return r?(0,o.tZ)(k,{organization:r}):(0,o.tZ)(p.ij,{organizationData:t.publicOrganizationData,elementId:"taskChooseOrganization",elementDescriptor:l.descriptors.taskChooseOrganizationPreviewItem,children:(0,o.tZ)(p.De,{isLoading:a.isLoading,onClick:()=>a.runAsync(async()=>[await t.accept(),await e(t.publicOrganizationData.id)]).then(t=>{var a;let[e,o]=t;null==d||null==(a=d.setData)||a.call(d,t=>(0,v.Sz)(e,t,"negative")),s(o)}).catch(t=>(0,Z.S3)(t,[],a.setError)),localizationKey:(0,l.localizationKeys)("taskChooseOrganization.chooseOrganization.action__invitationAccept")})})},f=(0,c.withCardStateProvider)(t=>{let a=(0,c.useCardState)(),{userSuggestions:e}=(0,i.eW)({userSuggestions:v.AO.userSuggestions});return(0,o.tZ)(p.ij,{organizationData:t.publicOrganizationData,elementId:"taskChooseOrganization",elementDescriptor:l.descriptors.taskChooseOrganizationPreviewItem,children:"accepted"===t.status?(0,o.tZ)(l.Text,{colorScheme:"secondary",localizationKey:(0,l.localizationKeys)("taskChooseOrganization.chooseOrganization.suggestionsAcceptedLabel")}):(0,o.tZ)(p.De,{onClick:()=>a.runAsync(t.accept).then(t=>{var a;return null==e||null==(a=e.setData)?void 0:a.call(e,a=>(0,v.Sz)(t,a))}).catch(t=>(0,Z.S3)(t,[],a.setError)),isLoading:a.isLoading,localizationKey:(0,l.localizationKeys)("taskChooseOrganization.chooseOrganization.action__suggestionsAccept")})})}),w=t=>{let{onCreateOrganizationClick:a}=t,{user:e}=(0,i.aF)();return(null==e?void 0:e.createOrganizationEnabled)?(0,o.tZ)(C.aU,{elementDescriptor:l.descriptors.taskChooseOrganizationCreateOrganizationActionButton,icon:O.mm,label:(0,l.localizationKeys)("taskChooseOrganization.chooseOrganization.action__createOrganization"),onClick:a,sx:t=>({borderTopWidth:t.borderWidths.$normal,borderTopStyle:t.borderStyles.$solid,borderTopColor:t.colors.$borderAlpha100,padding:"".concat(t.space.$5," ").concat(t.space.$5)}),iconSx:t=>({width:t.sizes.$9,height:t.sizes.$6})}):null};e(50725),e(70332);var S=e(8181),D=e(70431),K=e(19460),x=e(68487),$=e(53412),P=e(7259),A=e(36788),L=e(30215);function I(t){let{organizationCreationDefaults:a}=t,e=F(null==a?void 0:a.advisory);return e?(0,o.tZ)(L.bZ,{colorScheme:"warning",children:(0,o.tZ)(l.Text,{colorScheme:"warning",localizationKey:e,variant:"caption"})}):null}let F=t=>t&&"organization_already_exists"===t.code?(0,l.localizationKeys)("taskChooseOrganization.alerts.organizationAlreadyExists",{organizationDomain:t.meta.organization_domain,organizationName:t.meta.organization_name}):null,T=t=>{var a,e,s,u,g,h,z,p;let C=(0,c.useCardState)(),{navigateOnSetActive:y}=(0,m.G)(),{redirectUrlComplete:b}=(0,m._)(),{createOrganization:k,isLoaded:_,setActive:f}=(0,i.eW)({userMemberships:v.AO.userMemberships}),{organizationSettings:w}=(0,r.useEnvironment)(),[L,F]=(0,n.useState)(),T=(0,A.Yp)("name",null!=(z=null==(e=t.organizationCreationDefaults)||null==(a=e.form)?void 0:a.name)?z:"",{type:"text",label:(0,l.localizationKeys)("taskChooseOrganization.createOrganization.formFieldLabel__name"),placeholder:(0,l.localizationKeys)("taskChooseOrganization.createOrganization.formFieldInputPlaceholder__name")}),B=(0,A.Yp)("slug",null!=(p=null==(u=t.organizationCreationDefaults)||null==(s=u.form)?void 0:s.slug)?p:"",{type:"text",label:(0,l.localizationKeys)("taskChooseOrganization.createOrganization.formFieldLabel__slug"),placeholder:(0,l.localizationKeys)("taskChooseOrganization.createOrganization.formFieldInputPlaceholder__slug")}),R=!w.slug.disabled,E=async t=>{if(t.preventDefault(),_)try{let t={name:T.value};R&&(t.slug=B.value);let a=await k(t),e=X(a);await Promise.allSettled([e]),await f({organization:a,navigate:async t=>{let{session:a}=t;await (null==y?void 0:y({session:a,redirectUrlComplete:b}))}})}catch(t){(0,Z.S3)(t,[T,B],C.setError)}},X=async t=>{if(L)await t.setLogo({file:L});else if(W){let a=await fetch(W),e=await a.blob(),o=new File([e],"logo",{type:e.type});await t.setLogo({file:o})}},N=t=>{B.setValue(t)},U=!T.value||!_,W=void 0===L?null==(h=t.organizationCreationDefaults)||null==(g=h.form)?void 0:g.logo:void 0;return(0,o.BX)(o.HY,{children:[(0,o.BX)(d.h.Root,{showLogo:!0,sx:t=>({padding:"".concat(t.space.$none," ").concat(t.space.$8)}),children:[(0,o.tZ)(d.h.Title,{localizationKey:(0,l.localizationKeys)("taskChooseOrganization.createOrganization.title")}),(0,o.tZ)(d.h.Subtitle,{localizationKey:(0,l.localizationKeys)("taskChooseOrganization.createOrganization.subtitle")})]}),(0,o.tZ)(x.Y,{sx:t=>({padding:"".concat(t.space.$none," ").concat(t.space.$10," ").concat(t.space.$8)}),children:(0,o.BX)(D.l.Root,{onSubmit:E,children:[(0,o.tZ)(I,{organizationCreationDefaults:t.organizationCreationDefaults}),(0,o.tZ)(S.D,{organization:{name:T.value,imageUrl:null!=W?W:void 0},onAvatarChange:async t=>await F(t),onAvatarRemove:L||W?()=>(C.setIdle(),F(null)):null,showLoadingSpinner:!!W,avatarPreviewPlaceholder:(0,o.tZ)($.h,{variant:"ghost","aria-label":"Upload organization logo",icon:(0,o.tZ)(l.Icon,{size:"md",icon:O.gq,sx:t=>({color:t.colors.$colorMutedForeground,transitionDuration:t.transitionDuration.$controls})}),sx:t=>({width:t.sizes.$16,height:t.sizes.$16,borderRadius:t.radii.$md,borderWidth:t.borderWidths.$normal,borderStyle:t.borderStyles.$dashed,borderColor:t.colors.$borderAlpha200,backgroundColor:t.colors.$neutralAlpha50,":hover":{backgroundColor:t.colors.$neutralAlpha50,svg:{transform:"scale(1.2)"}}})})}),(0,o.tZ)(D.l.ControlRow,{elementId:T.id,children:(0,o.tZ)(D.l.PlainInput,{...T.props,onChange:t=>{T.setValue(t.target.value),N((0,P.q)(t.target.value))},isRequired:!0,autoFocus:!0,ignorePasswordManager:!0})}),R&&(0,o.tZ)(D.l.ControlRow,{elementId:B.id,children:(0,o.tZ)(D.l.PlainInput,{...B.props,onChange:t=>N(t.target.value),isRequired:!0,pattern:"^(?=.*[a-z0-9])[a-z0-9\\-]+$",ignorePasswordManager:!0})}),(0,o.BX)(K.K,{sx:()=>({flexDirection:"column"}),children:[(0,o.tZ)(D.l.SubmitButton,{block:!0,isDisabled:U,localizationKey:(0,l.localizationKeys)("taskChooseOrganization.createOrganization.formButtonSubmit")}),t.onCancel&&(0,o.tZ)(D.l.ResetButton,{localizationKey:(0,l.localizationKeys)("taskChooseOrganization.createOrganization.formButtonReset"),onClick:t.onCancel})]})]})})]})},B=()=>{var t,a;let{signOut:e}=(0,i.cL)(),{user:n}=(0,i.aF)(),{session:c}=(0,i.kP)(),{otherSessions:d}=(0,u.j)({user:n}),{navigateAfterSignOut:g,navigateAfterMultiSessionSingleSignOutUrl:h}=(0,r.useSignOutContext)(),z=null!=(a=null==n||null==(t=n.primaryEmailAddress)?void 0:t.emailAddress)?a:null==n?void 0:n.username;return(0,o.tZ)(s.Z.Footer,{children:(0,o.BX)(s.Z.Action,{elementId:"signOut",gap:2,justify:"center",sx:()=>({width:"100%"}),children:[z&&(0,o.tZ)(s.Z.ActionText,{truncate:!0,localizationKey:(0,l.localizationKeys)("taskChooseOrganization.signOut.actionText",{identifier:z})}),(0,o.tZ)(s.Z.ActionLink,{sx:()=>({flexShrink:0}),onClick:()=>0===d.length?e(g):e(h,{sessionId:null==c?void 0:c.id}),localizationKey:(0,l.localizationKeys)("taskChooseOrganization.signOut.actionLink")})]})})},R=(0,c.withCardStateProvider)(t=>{let[a,e]=(0,n.useState)(t.initialFlow);return"create"===a?(0,o.tZ)(T,{onCancel:"choose"===t.initialFlow?()=>e("choose"):void 0,organizationCreationDefaults:t.organizationCreationDefaults}):(0,o.tZ)(b,{onCreateOrganizationClick:()=>e("create")})});function E(){return(0,o.tZ)(l.Flow.Root,{flow:"taskChooseOrganization",children:(0,o.tZ)(l.Flow.Part,{part:"organizationCreationDisabled",children:(0,o.BX)(s.Z.Root,{children:[(0,o.tZ)(s.Z.Content,{children:(0,o.BX)(d.h.Root,{showLogo:!0,children:[(0,o.tZ)(d.h.Title,{localizationKey:(0,l.localizationKeys)("taskChooseOrganization.organizationCreationDisabled.title")}),(0,o.tZ)(d.h.Subtitle,{localizationKey:(0,l.localizationKeys)("taskChooseOrganization.organizationCreationDisabled.subtitle")})]})}),(0,o.tZ)(B,{})]})})})}let X=(0,r.withCoreSessionSwitchGuard)((0,h.U)((0,c.withCardStateProvider)(()=>{let{user:t}=(0,i.aF)(),{userMemberships:a,userSuggestions:e,userInvitations:n}=(0,g.H)(),r=(0,i.vm)(),c=(null==a?void 0:a.isLoading)||(null==n?void 0:n.isLoading)||(null==e?void 0:e.isLoading)||(null==r?void 0:r.isLoading),d=!!((null==a?void 0:a.count)||(null==n?void 0:n.count)||(null==e?void 0:e.count));return c||(null==t?void 0:t.createOrganizationEnabled)||d?(0,o.tZ)(l.Flow.Root,{flow:"taskChooseOrganization",children:(0,o.tZ)(l.Flow.Part,{part:"chooseOrganization",children:(0,o.BX)(s.Z.Root,{children:[(0,o.tZ)(s.Z.Content,{sx:t=>({padding:"".concat(t.space.$8," ").concat(t.space.$none," ").concat(t.space.$none),gap:t.space.$7}),children:c?(0,o.tZ)(l.Flex,{direction:"row",align:"center",justify:"center",sx:t=>({height:"100%",minHeight:t.sizes.$100}),children:(0,o.tZ)(l.Spinner,{size:"lg",colorScheme:"primary",elementDescriptor:l.descriptors.spinner})}):(0,o.tZ)(R,{initialFlow:d?"choose":"create",organizationCreationDefaults:r.data})}),(0,o.tZ)(B,{})]})})}):(0,o.tZ)(E,{})}),"choose-organization"))},25135:function(t,a,e){e.d(a,{U:()=>r});var o=e(95274),i=e(96231),n=e(86988);let r=(t,a)=>{let e=t.displayName||t.name||"Component";t.displayName=e;let r=e=>{let r=(0,n.G)();return(0,i.me)(t,t=>{var e;return!(null==(e=t.session)?void 0:e.currentTask)||t.session.currentTask.key!==a&&!t.__internal_setActiveInProgress},t=>{var a;let{clerk:e}=t;return e.session?null!=(a=r.redirectUrlComplete)?a:e.buildAfterSignInUrl():e.buildSignInUrl()},o.q.cannotRenderComponentWhenTaskDoesNotExist)(e)};return r.displayName="withTaskGuard(".concat(e,")"),r}}}]);